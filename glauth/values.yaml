# Default values for glauth.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

replicaCount: 1

image:
  repository: glauth/glauth
  pullPolicy: IfNotPresent
  tag: "v2.3.2"

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

serviceAccount:
  # Specifies whether a service account should be created
  create: true
  # Annotations to add to the service account
  annotations: {}
  # The name of the service account to use.
  # If not set and create is true, a name is generated using the fullname template
  name: ""

podAnnotations: {}

podSecurityContext: {}
  # fsGroup: 2000

securityContext: {}
  # capabilities:
  #   drop:
  #   - ALL
  # readOnlyRootFilesystem: true
  # runAsNonRoot: true
  # runAsUser: 1000

service:
  # On-premises: Use NodePort for external access
  type: NodePort
  ldapPort: 3893
  apiPort: 5555
  # Custom NodePorts to avoid conflicts with other services
  nodePorts:
    ldap: 30389  # LDAP NodePort (30000-32767 range)
    api: 30555   # API NodePort (30000-32767 range)
  
  # Cloud environments: Uncomment for LoadBalancer
  # type: LoadBalancer
  # annotations:
  #   service.beta.kubernetes.io/aws-load-balancer-type: "nlb"  # For AWS
  #   service.beta.kubernetes.io/azure-load-balancer-internal: "false"  # For Azure
  #   service.beta.kubernetes.io/gce-load-balancer-type: "External"  # For GCP

resources: {}
  # We usually recommend not to specify default resources and to leave this as a conscious
  # choice for the user. This also increases chances charts run on environments with little
  # resources, such as Minikube. If you do want to specify resources, uncomment the following
  # lines, adjust them as necessary, and remove the curly braces after 'resources:'.
  # limits:
  #   cpu: 100m
  #   memory: 128Mi
  # requests:
  #   cpu: 100m
  #   memory: 128Mi

autoscaling:
  enabled: false
  minReplicas: 1
  maxReplicas: 100
  targetCPUUtilizationPercentage: 80
  # targetMemoryUtilizationPercentage: 80

nodeSelector: {}

tolerations: []

affinity: {}

# GLAuth Configuration
appConfig: |
  [ldap]
    enabled = true
    listen = "0.0.0.0:3893"

  [ldaps]
    enabled = false

  [api]
    enabled = true
    internals = true
    tls = false
    listen = "0.0.0.0:5555"

  [backend]
    datastore = "config"
    baseDN = "dc=example,dc=com"

  [behaviors]
    IgnoreCapabilities = false
    LimitFailedBinds = true
    NumberOfFailedBinds = 3
    PeriodOfFailedBinds = 10
    BlockFailedBindsFor = 60
    PruneSourceTableEvery = 600
    PruneSourcesOlderThan = 600

  [[users]]
    name = "tesla"
    sn = "Tesla"
    mail = "tesla@example.com"
    uidnumber = 5001
    primarygroup = 5501
    loginShell = "/bin/bash"
    homeDir = "/home/user"
    # Password: password (SHA256)
    passsha256 = "5e884898da28047151d0e56f8dc6292773603d0d6aabbdd62a11ef721d1542d8"
    [[users.customattributes]]
      displayName = ["Nikola Tesla"]
      objectClass = ["user"]
    [[users.capabilities]]
      action = "search"
      object = "*"

  [[users]]
    name = "einstein"
    sn = "Einstein"
    mail = "einstein@example.com"
    uidnumber = 5002
    primarygroup = 5501
    loginShell = "/bin/bash"
    homeDir = "/home/user"
    # Password: password (SHA256)
    passsha256 = "5e884898da28047151d0e56f8dc6292773603d0d6aabbdd62a11ef721d1542d8"
    [[users.customattributes]]
      displayName = ["Albert Einstein"]
      objectClass = ["user"]
    [[users.capabilities]]
      action = "search"
      object = "*"

  [[groups]]
    name = "users"
    gidnumber = 5501
